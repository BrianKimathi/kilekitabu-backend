Implementation Guide
Webhooks
REST API
Cybersource Contact Information
For general information about our company, products, and services, go to https://www.cybersource.com.
For sales questions about any Cybersource service, email sales@cybersource.com or call 650-432-7350 or 888-330-2300 (toll free in
the United States).
For support information about any Cybersource service, visit the Support Center: https://www.cybersource.com/support
Copyright
© 2020. Cybersource Corporation. All rights reserved. Cybersource Corporation (“Cybersource”) furnishes this document and the
software described in this document under the applicable agreement between the reader of this document (“You”) and Cybersource
(“Agreement”). You may use this document and/or software only in accordance with the terms of the Agreement. Except as expressly
set forth in the Agreement, the information contained in this document is subject to change without notice and therefore should not
be interpreted in any way as a guarantee or warranty by Cybersource. Cybersource assumes no responsibility or liability for any errors
that may appear in this document. The copyrighted software that accompanies this document is licensed to You for use only in strict
accordance with the Agreement. You should read the Agreement carefully before using the software. Except as permitted by the
Agreement, You may not reproduce any part of this document, store this document in a retrieval system, or transmit this document, in
any form or by any means, electronic, mechanical, recording, or otherwise, without the prior written consent of Cybersource.
Restricted Rights Legends
For Government or defense agencies:Use,duplication, or disclosure by the Government or defense agencies is subject to restrictions
as set forth the Rights in Technical Data and Computer Software clause at DFARS 252.227-7013 and in similar clauses in the FAR and
NASA FAR Supplement.
For civilian agencies: Use, reproduction, or disclosure is subject to restrictions set forth in suparagraphs (a) through (d) of the
Commercial Computer Software Restricted Rights clause at 52.227-19 and the limitations set forth in Cybersource Corporation's
standard commercial agreement for this software. Unpublished rights reserved under the copyright laws of the United States.
Trademarks
Authorize.Net, eCheck.Net, and The Power of Payment are registered trademarks of Cybersource Corporation. Cybersource,
Cybersource Payment Manager, Cybersource Risk Manager, Cybersource Decision Manager, and Cybersource Connect are trademarks
and/or service marks of Cybersource Corporation. Visa, Visa International, Cybersource, the Visa logo, and the Cybersource logo
are the registered trademarks of Visa International in the United States and other countries. All other trademarks, service marks,
registered marks, or registered service marks are the property of their respective owners.
Condentiality Notice
This document is furnished to you solely in your capacity as a client of Cybersource and as a participant in the Visa payments system.
By accepting this document, you acknowledge that the information contained herein (the “Information”) is condential and subject
to the condentiality restrictions contained in Visa's operating regulations and/or other condentiality agreements, which limity our
use of the Information. You agree to keep the Information condential and not to use the Information for any purpose other than its
intended purpose and in your capacity as a customer of Cybersource or as a participant in the Visa payments system. The Information
may only be disseminated within your organization on a need-to-know basis to enable your participation in the Visa payments system.
Please be advised that the Information may constitute material non-public information under U.S. federal securities laws and that
purchasing or selling securities of Visa Inc. while being aware of material non-public information would constitute a violation of
applicable U.S. federal securities laws.
Revision
Version: 25.10.01
Contents
Contents
Webhooks Implementation Guide................................................................................................... 6
Limited Availability Release.....................................................................................................7
Recent Revisions to This Document......................................................................................7
VISA Platform Connect: Specications and Conditions for Resellers/Partners........... 8
Introduction to Webhooks................................................................................................................9
How to Prepare Your System to Support Webhooks.................................................................. 11
How to Set Up Webhook Subscriptions........................................................................................13
Supported Products and Event Types..........................................................................................16
Set Up Your Server Security..........................................................................................................20
Create REST API Keys...................................................................................................................... 21
Create a Shared Secret Key Pair......................................................................................... 21
Create a P12 Certicate....................................................................................................... 26
Create a Digital Signature Key......................................................................................................30
Required Fields for Creating a Digital Signature Key....................................................... 31
Example: Creating a Digital Signature Key..........................................................................31
REST Interactive Example: Creating a Digital Signature Key.......................................... 32
Provide Your OAuth Credentials................................................................................................... 33
Required Fields for Providing Your OAuth Credentials....................................................34
Example: Providing Your OAuth Credentials......................................................................34
REST Interactive Example: Providing Your OAuth Credentials....................................... 35
Retrieve a List of Products and Events....................................................................................... 36
Example: Retrieving a List Products and Event.................................................................36
REST Interactive Example: Retrieving Product and Event Types....................................37
Create a Webhook Subscription................................................................................................... 39
Create a Webhook Subscription Using Mutual Trust.......................................................39
Required Fields for Subscribing to Webhooks Using Mutual Trust...................... 40
Optional Fields for Subscribing to Webhooks Using Mutual Trust.......................40
Example: Creating a Webhook Subscription Using Mutual Trust...........................41
Create a Webhook Subscription Using OAuth..................................................................44
Required Fields for Subscribing to Webhooks Using OAuth................................. 45
Optional Fields for Subscribing to Webhooks Using OAuth..................................46
Cybersource Contents 3
Contents
Example: Creating a Webhook Subscription Using OAuth.....................................46
Create a Webhook Subscription Using OAuth with JWT.................................................50
Required Fields for Subscribing to Webhooks Using OAuth with JWT................. 51
Optional Fields for Subscribing to Webhooks Using OAuth with JWT................. 52
Example: Creating a Webhook Subscription Using OAuth with JWT....................53
Examples of all Products and Event Types........................................................................ 56
Request Examples for Creating a Subscription for all Products and Event
Types....................................................................................................................... 56
Optional Set-Up Tasks.....................................................................................................................61
Webhook Health Check URL and Automatic Revalidation............................................... 61
Congure the Retry Policy................................................................................................... 63
Example: Retry Policy in a Subscription Request....................................................63
Validate a Webhook Notication.........................................................................................64
Digital Signature Format............................................................................................. 64
Validating a Notication..............................................................................................64
Example: Validating a Notication.............................................................................65
Webhook Notication Header and Message Body Descriptions.............................................69
Example: Webhook Notication........................................................................................... 70
Create a Sample Webhook Subscription..................................................................................... 72
Manage Webhook Subscriptions Requests................................................................................. 75
Retrieve the Details of a Webhook Subscription..............................................................75
Example: Retrieving the Details of a Webhook Subscription.................................76
Response Codes........................................................................................................... 76
REST Interactive Example: Retrieve the Details of a Webhook Subscription......76
Retrieve all of an Organization's Subscriptions.................................................................77
Required Query Parameters for Retrieving all of an Organization's
Subscriptions......................................................................................................... 78
Optional Query Parameters for Retrieving all of an Organization's
Subscriptions......................................................................................................... 78
Example: Retrieving all of an Organization's Subscriptions................................... 78
Response Codes........................................................................................................... 78
REST Interactive Example: Retrieving all of an Organization's Subscriptions..... 78
Update a Webhook Subscription......................................................................................... 79
Optional Fields for Updating a Webhook Subscription..........................................80
Example: Updating a Webhook Subscription............................................................ 81
Response Codes............................................................................................................81
REST Interactive Example: Updating a Webhook Subscription..............................81
Delete a Webhook Subscription.......................................................................................... 82
Example: Deleting a Webhook Subscription.............................................................83
Response Codes...........................................................................................................83
REST Interactive Example: Deleting a Webhook Subscription.............................. 83
Verify a Webhook Subscription's Conguration...............................................................84
Example: Verifying a Webhook Subscription's Conguration............................... 85
Response Codes...........................................................................................................85
REST Interactive Example: Verifying a Webhook Subscription's
Conguration.........................................................................................................85
Cybersource Contents 4
Contents
Activate a Webhook Subscription.......................................................................................86
Example: Activate a Webhook Subscription.............................................................87
Response Codes........................................................................................................... 87
REST Interactive Example: Activating a Webhook Subscription........................... 87
Deactivate a Webhook Subscription...................................................................................88
Example: Deactivate a Webhook Subscription........................................................ 89
Response Codes...........................................................................................................89
REST Interactive Example: Deactivating a Webhook Subscription.......................89
Troubleshooting Webhook Subscriptions.................................................................................... 91
Cybersource Contents 5
Webhooks Implementation Guide
Webhooks Implementation
Guide
This guide provides information about Webhook features that you can include in your
system:
• Multiple security options. For example, server security policy and digital signature
verication.
• Multiple possible workows based on the security policy you choose.
• The process for setting up and using the feature.
Convention This special statement is used in this
document:
Important
An Important statement
contains information essential to
successfully completing a task or
learning a concept.
Related Documentation Refer to the Technical Documentation
Portal for more technical documentation:
https://developer.cybersource.com/
docs.html
Customer Support For support information about any service,
visit the Support Center:
http://support.cybersource.com
Cybersource Webhooks Implementation Guide 6
Webhooks Implementation Guide
Limited Availability Release
This document provides information about the limited availability release of the Webhooks
REST API.
Recent Revisions to This Document
25.10.01
This revision contains only editorial changes and no technical updates.
25.09.02
Added support for the tms.networktoken.binding webhook event type, which noties you
of the binding status of a network token to a device. See Supported Products and Event
Types on page 16.
25.09.01
Added examples of creating a webhook subscription for eCheck events. See the eCheck
section in Request Examples for Creating a Subscription for all Products and Event Types
on page 56.
25.08.01
This guide has been reorganized.
25.03.01
Managing Subscriptions Added additional information about why
you should include a health check URL
when subscribing to a webhook event. See
Webhook Health Check URL and Automatic
Revalidation on page 61.
Product and Events Removed support for the
cns.report.keyExpiration.detail webhook
event type, which would notify you when
a key is expiring. See Supported Products
and Event Types on page 16.
25.02.02
Products and Events Added support for new Invoicing product
events. See Supported Products and Event
Types on page 16.
Cybersource Webhooks Implementation Guide 7
Webhooks Implementation Guide
25.02.01
Products and Events Added support for new Invoicing product
events. See Supported Products and Event
Types on page 16.
Updated product event types and descriptions. See Supported Products and Event Types
on page 16.
VISA Platform Connect: Specications and
Conditions for Resellers/Partners
The following are specications and conditions that apply to a Reseller/Partner enabling
its merchants through Cybersource for Visa Platform Connect (“VPC”) processing. Failure
to meet any of the specications and conditions below is subject to the liability provisions
and indemnication obligations under Reseller/Partner’s contract with Visa/Cybersource.
1. Before boarding merchants for payment processing on a VPC acquirer’s connection,
Reseller/Partner and the VPC acquirer must have a contract or other legal agreement
that permits Reseller/Partner to enable its merchants to process payments with the
acquirer through the dedicated VPC connection and/or traditional connection with
such VPC acquirer.
2. Reseller/Partner is responsible for boarding and enabling its merchants in accordance
with the terms of the contract or other legal agreement with the relevant VPC acquirer.
3. Reseller/Partner acknowledges and agrees that all considerations and fees associated
with chargebacks, interchange downgrades, settlement issues, funding delays, and
other processing related activities are strictly between Reseller and the relevant VPC
acquirer.
4. Reseller/Partner acknowledges and agrees that the relevant VPC acquirer is
responsible for payment processing issues, including but not limited to, transaction
declines by network/issuer, decline rates, and interchange qualication, as may be
agreed to or outlined in the contract or other legal agreement between Reseller/
Partner and such VPC acquirer.
DISCLAIMER: NEITHER VISA NOR CYBERSOURCE WILL BE RESPONSIBLE OR LIABLE FOR
ANY ERRORS OR OMISSIONS BY THE Visa Platform Connect ACQUIRER IN PROCESSING
TRANSACTIONS. NEITHER VISA NOR CYBERSOURCE WILL BE RESPONSIBLE OR LIABLE
FOR RESELLER/PARTNER BOARDING MERCHANTS OR ENABLING MERCHANT PROCESSING
IN VIOLATION OF THE TERMS AND CONDITIONS IMPOSED BY THE RELEVANT Visa Platform
Connect ACQUIRER.
Cybersource Webhooks Implementation Guide 8
Introduction to Webhooks
Introduction to Webhooks
Webhooks are automated notications that are generated and sent to you when specic
system events occur. By using the Webhooks REST API, you can subscribe to receive these
notications for events of your choice and designate a URL in your system to receive the
notications. This is helpful for events that are not a part of an API request and response,
or are not available through the Reporting API. For example, you can receive webhook
notications when these events occur:
• Fraud alerts
• Invoice status updates
• Network token is provisioned
• Transaction monitoring
• Recurring billing
You can also congure your system to respond to the events in any way you choose.
The Webhooks REST API enables you to:
• Create webhook subscriptions to receive automatic system notications
• Update and delete existing webhook subscriptions
• Check the status of a webhook notication
• Retrieve webhook notication history and details
For more information about the products and event types that you can receive
notications for, see Supported Products and Event Types on page 16.
Benets
The Webhooks API provides these key benets:
• Visibility into system events that are otherwise not visible.
• Ability to respond to events programmatically and to automate workows.
Test Methods for Webhooks
You can test the Webhooks REST API using the Postman application or the Cybersource
Developer Center's live console.
Cybersource Introduction to Webhooks 9
Introduction to Webhooks
Postman A Postman collection is available for you to
test the Webhooks REST API. Contact your
account manager to request the collection.
Developer Center Live Console The Cybersource Developer Center
offers the live console for you to test
complete examples and view the API eld
descriptions. See the Webhooks section in
the REST API Reference.
Cybersource Introduction to Webhooks 10
How to Prepare Your System to Support Webhooks
How to Prepare Your System
to Support Webhooks
You must complete these prerequisites before beginning to set up your webhooks
subscriptions.
Webhooks Server
You must set up a server with a URL to receive webhook notications. You can also
set up an additional URL for the health check service. For more information about how
Cybersource uses your health check URL, see Webhook Health Check URL and Automatic
Revalidation on page 61.
Security Policy Options
Your system must support the mutual trust security policy to authenticate webhook
notications. Mutual trust is a simple authentication scheme that is included in the HTTP
protocol. It is often used in conjunction with HTTPS to provide condentiality through
encryption.
In addition to mutual trust, you can also use the OAuth or OAuth JWT security policy to
authenticate your webhook notications.
Business Center Account and Security Keys
You must have an organization or merchant account (MID) and REST API security keys.
If you do not have an account, you can sign up for test account on the Developer Center:
https://developer.cybersource.com/hello-world/sandbox.html
During the test account signup, you receive a REST API security key to test the APIs.
To create new REST API security keys, see the Creating and Using Security Keys User
Guide.
Getting Started with the REST API
To begin implementing webhooks through Cybersource, you must set up your system to
be REST compliant. Cybersource uses the REST architecture for developing web services.
REST enables communication between a client and server using HTTP protocols.
Cybersource How to Prepare Your System to Support Webhooks 11
How to Prepare Your System to Support Webhooks
If you have not set up secure communications between your client and server using either
a JSON Web Token or HTTP signature, see the
Getting Started with the REST API.
Cybersource How to Prepare Your System to Support Webhooks 12
How to Set Up Webhook Subscriptions
How to Set Up Webhook
Subscriptions
Follow these steps to set up your system to support the Webooks REST API. Some of
these steps are dependent on your system's security policy.
Cybersource How to Set Up Webhook Subscriptions 13
How to Set Up Webhook Subscriptions
Set Up Webhook Subscriptions Workow
1. Congure your server security to receive webhooks notications. For more
information, see Set Up Your Server Security on page 20.
2. Create a REST API security key that is compliant with your security policy. Security
keys are used to authenticate the requests you send to Cybersource. You must create
separate keys for the testing and production environments. For more information, see
Create REST API Keys on page 21.
3. Request a digital signature key from Cybersource. For more information, see Create a
Digital Signature Key on page 30.
4. If your system uses the OAuth or OAuth with JWT security policy, you must provide
your OAuth credentials to Cybersource. For more information, see Provide Your OAuth
Credentials on page 33.
Cybersource How to Set Up Webhook Subscriptions 14
How to Set Up Webhook Subscriptions
5. Request a list of the products that your organization is enabled to receive webhook
notications for. For more information, see Retrieve a List of Products and Events on
page 36.
6. Create your webhook subscription event notications. For more information, see
Create a Webhook Subscription on page 39.
Optional Set Up Tasks
These are optional tasks you can complete after creating a webhook subscription.
• Include a health check URL to enable Cybersource to monitor your server's status
for reliability. For more information, see Webhook Health Check URL and Automatic
Revalidation on page 61.
• Customize the retry policy for unresponsive webhook and health check URLs. For more
information, see Congure the Retry Policy on page 63.
• Validate your digital signature. For more information, see Validate a Webhook
Notication on page 64.
Cybersource How to Set Up Webhook Subscriptions 15
Supported Products and Event Types
Supported Products and
Event Types
This section describes all of the products and event types that are supported by the
Webhooks REST API.
When you create a webhook subscription, you must include a Cybersource product and
one of its corresponding event types in your request. You can include multiple products
and event types in the same request. Every time one of the events that you subscribe to
occurs, you receive a notication. If you subscribe to a product that is not enabled for
your account, you receive a notication when it is enabled. To retrieve a list of the enabled
products that your organization can subscribe to, see Retrieve a List of Products and
Events on page 36.
When you send a create a webhook subscription request, set the productId eld to a value
listed in the Product ID column. Set the eventTypes eld array to a value listed in the Event
Types column. If you are subscribing to multiple products and event types, separate each
value with the comma character (,). For reference examples of how to properly format
these elds and values in a request, see Examples of all Products and Event Types on page
56.
These are all of the webhook supported products, event types, and their corresponding
eld values:
Alternative Payment Methods
Product ID Event Types Description
alternativePay
mentMethods
payments.payments.updated Notifies you that an alternative pa
yment transaction's status has
 been updated.
Cybersource Supported Products and Event Types 16
Supported Products and Event Types
eCheck
Product ID Event Types Description
payments.credits.accepted Notifies you of a successful eChec
k credit transaction.
payments.credits.failed Notifies you of an eCheck credit tr
ansaction failure.
payments.payments.accepted Notifies you of a successful eChec
k debit transaction.
payments.payments.failed Notifies you of an eCheck debit tra
nsaction failure.
payments.voids.accepted Notifies you of a successful eChec
k void transaction.
eCheck
payments.voids.failed Notifies you of an eCheck void tra
nsaction failure.
Fraud Management Essentials
Product ID Event Types Description
risk.casemanagement.decision.ac
cept
Notifies you that a Fraud Managem
ent Essentials case has been a
ccepted.
risk.casemanagement.addnote Notifies you that a note has been a
dded to a Fraud Management E
ssentials case.
risk.profile.decision.reject Notifies you that a transaction was
 rejected.
risk.casemanagement.decision.rej
ect
Notifies you that a Fraud Managem
ent Essentials case has been r
ejected.
risk.profile.decision.monitor Notifies you of a profile decision to
 monitor a transaction.
fraudManagem
entEssentials
risk.profile.decision.review Notifies you of a profile decision to
 review a transaction.
Cybersource Supported Products and Event Types 17
Supported Products and Event Types
Invoicing
Product ID Event Types Description
invoicing.customer.invoice.send Notifies you that an invoice has be
en sent.
invoicing.customer.invoice.cancel Notifies you that an invoice has be
en cancelled.
invoicing.customer.invoice.paid Notifies you that an invoice has be
en paid.
invoicing.customer.invoice.partialpayment
Notifies you that an invoice has be
en partially paid.
invoicing.customer.invoice.remind
er
Notifies you 5 days before the invo
ice payment is due. This event
is triggered if you have invoice rem
inders enabled in your invoice
settings.
customer
Invoicing
invoicing.customer.invoice.overdu
e-reminder
Notifies you 1 day after the invoice
 payment is due.This event is t
riggered if you have invoice remind
ers enabled in your invoice set
tings.
Payments
Product ID Event Types Description
payments.capture.status.accepte
d
Notifies you that a payment captur
e request is accepted by Cybe
rsource.
payments
payments.capture.status.updated Notifies you that a payment captur
e is updated.
Pay by Link
Product ID Event Types Description
payByLink payByLink.merchant.payment Merchants can subscribe to this e
vent type to automate how th
eir system is informed when a cust
omer completes a payment.
Cybersource Supported Products and Event Types 18
Supported Products and Event Types
Product ID Event Types Description
payByLink.customer.payment Partner resellers can subscribe to
 this event type to control the
 distribution of the payment confir
mation email sent to their mer
chants' customers.
Recurring Billing
Product ID Event Types Description
rbs.subscriptions.charge.failed Notifies you of a recurring paymen
t failure.
rbs.subscriptions.charge.pre-noti
fied
Notifies you of an upcoming recurr
ing payment. recurringBilling
rbs.subscriptions.charge.created Notifies you of successful recurrin
g payment.
Token Management Service
Product ID Event Types Description
tms.networktoken.updated Notifies you of a network token's c
hange in expiration date or sta
tus (suspend, resume, or deac
tivate).
tms.networktoken.provisioned Notifies you when a network token
 provision for an instrument id
entifier token has been succes
sful.
tokenMan
agement
tms.networktoken.binding Notifies you of the binding status
of a network token with a devi
ce.
Cybersource Supported Products and Event Types 19
Set Up Your Server Security
Set Up Your Server Security
Complete these tasks to congure your server to receive secure webhook notications.
Allowlist
Add these IP addresses to your allowlist to permit Cybersource to deliver your webhook
notications:
• 198.241.206.21
• 198.241.207.21
Trusting the Root Certicate
Download the Visa Corporate Root CA G2 certicate from the Visa Public Key
Infrastructure webpage, and add it to your Java keystore: http://enroll.visaca.com
Cybersource Set Up Your Server Security 20
Create REST API Keys
Create REST API Keys
The Webhooks REST API requires you to create a shared secret key pair. You may have
already completed this requirement if your system is currently REST compliant. If you
are using the OAuth with JWT security policy, you must also create a P12 certicate. The
shared secret key pair and P12 certicate are also known as REST API keys. REST API keys
are used to enable secure communication between you and Cybersource when using the
REST API.
• Shared secret key pair: A key pair used for HTTP signature authentication. It is consists
of a key and a shared secret key. See Create a Shared Secret Key Pair on page 21.
• P12 certicate: A key used for JSON Web Token authentication. It consists of .p12 le
and a password that you must set to use the le. See Create a P12 Certicate on page
26.
When using the test and production environments, you must create separate keys for
each environment.
Securely store your created keys in your system. You must be able to access your key
credentials while implementing and managing webhook subscriptions.
REST API keys expire after 3 years.
Create a Shared Secret Key Pair
The Webhook REST API requires you to create a shared secret key pair. You may have
already completed this requirement if your system is currently REST compliant.
Follow these steps to create a shared secret key pair.
1. Log in to the Business Center:
• Test: https://businesscentertest.cybersource.com
• Production: https://businesscenter.cybersource.com
2.
On the left navigation panel, choose Payment Conguration > Key Management.
Cybersource Create REST API Keys 21
Create REST API Keys
3. Click + Generate key.
Cybersource Create REST API Keys 22
Create REST API Keys
4. Under REST APIs, choose REST – Shared Secret and then click Generate key.
The REST API Shared Secret Key page appears.
Cybersource Create REST API Keys 23
Create REST API Keys
5. Click Download key
Cybersource Create REST API Keys 24
Create REST API Keys
The .pem le is downloaded to your desktop.
You can create or upload another key by clicking Generate another key. To view all of your
created keys, use the Key Management page.
Important
Securely store the shared secret key pair in your system. You must be able to
retrieve these credentials to implement the Webhooks REST API.
Cybersource Create REST API Keys 25
Create REST API Keys
Create a P12 Certicate
If you are using the OAuth with JWT security policy, you must create a P12 certicate in
addition to a shared secret key pair. You may have already completed this requirement if
your system is currently REST compliant.
Follow these steps to create a .p12 le if you are using JSON Web Tokens to secure
communication.
1. Log in to the Business Center:
• Test: https://businesscentertest.cybersource.com
• Production: https://businesscenter.cybersource.com
2.
On the left navigation panel, choose Payment Conguration > Key Management.
Cybersource Create REST API Keys 26
Create REST API Keys
3. Click + Generate key.
4. Under REST APIs, choose REST – Certicate, and then click Generate key.
If you are using a portfolio account, the Key options window appears, giving you the
choice to create a meta key. For more information about how to create a meta key, see
Meta Key Creation and Management.
5.
Click Download key .
Cybersource Create REST API Keys 27
Create REST API Keys
6. Create a password for the certicate by entering the password into the New Password
and Conrm Password elds, and then click Generate key.
Cybersource Create REST API Keys 28
Create REST API Keys
The .p12 le downloads to your desktop.
If prompted by your system, approve the location for where the key downloads.
You can create or upload another key by clicking Generate another key. To view all of your
created keys, use the Key Management page.
Important
Securely store the .p12 le and password in your system.
Cybersource Create REST API Keys 29
Create a Digital Signature Key
Create a Digital Signature
Key
This section describes how to create a digital signature key. You must create a digital
signature key in order for Cybersource to send notications to your servers. You only
need to send this request once for each account. Sending this request again using the
same account credentials results in the same digital signature key.
Important
Store the created digital signature key in a secure location in your system.
Optional Notication Validation
After you set up a webhook subscription, you can validate each notication you receive
using your digital signature key. When Cybersource sends you a notication, your digital
signature key is included in the notication's header. You can congure your system to
validate that each notication contains your digital signature key in its header. Validating a
webhook notication veries the notication's integrity and prevents replay attacks. For
more information, see Validate a Webhook Notication on page 64.
Endpoints
Send a POST request to one of these endpoints:
• Test: POST https://apitest.cybersource.com/kms/egress/v2/keys-sym
• Production: POST https://api.cybersource.com/kms/egress/v2/keys-sym
• India Production: POST https://api.in.cybersource.com/kms/egress/v2/keys-sym
Cybersource Create a Digital Signature Key 30
Create a Digital Signature Key
Required Fields for Creating a Digital
Signature Key
clientRequestAction Set the value to CREATE.
keyInformation.expiryDuration
keyInformation.keyType Set the value to sharedSecret.
keyInformation.organizationId Set the value to the organization ID of the
organization requesting the key.
keyInformation.provider Set the value to nrtd.
keyInformation.tenant Set the value to the organization ID of the
organization requesting the key.
Example: Creating a Digital Signature Key
{
"clientRequestAction": "CREATE",
"keyInformation": {
"provider": "nrtd",
"tenant": "merchantName",
"keyType": "sharedSecret",
"organizationId": "merchantName"
 }
}
{
"submitTimeUtc": "2021-03-17T06:53:06+0000",
"status": "SUCCESS",
"keyInformation": {
"provider": "NRTD",
"tenant": "merchantName",
"organizationId": "merchantName",
"keyId": "bdc0fe52-091e-b0d6-e053-34b8d30a0504", //ID associated with the key in the key eld
"key": "u3qgvoaJ73rLJdPLTU3moxrXyNZA4eo5dklKtIXhsAE=", //Base64 encoded key
"keyType": "sharedSecret",
"status": "Active",
"expirationDate": "2022-03-17T06:53:06+0000"
}
Cybersource Create a Digital Signature Key 31
Create a Digital Signature Key
REST Interactive Example: Creating a Digital
Signature Key
Click this image to access the interactive code example for creating a digital signature
key. The Live Console refers to this request as Create Webhook Symmetric Key.
Creating a Digital Signature Key
Cybersource Create a Digital Signature Key 32
Provide Your OAuth Credentials
Provide Your OAuth
Credentials
If your system uses the OAuth or OAuth with JWT security policy, you must provide your
OAuth credentials to Cybersource. When Cybersource sends you webhook notications in
the future, Cybersource will use your OAuth credentials to access your server and deliver
the notication message.
Important
If you are only using the default mutual trust security policy, you do not need to
provide OAuth credentials to Cybersource.
OAuth The OAuth security policy with client
credentials is an authentication method
that is designed for applications to
communicate with each other. Basic
authentication is the most common
mechanism for authenticating a client with
the client credentials. This authentication
method enables Cybersource services to
obtain only the relevant user data without
exposing the user's credentials.
OAuth with JWT The OAuth with JWT security policy
is an authentication method in which
your system sends a JSON Web Token.
This method bypasses domain headers
and minimizes the need for server-side
authentication checks.
Endpoints
Send a POST to one of these endpoints:
Cybersource Provide Your OAuth Credentials 33
Provide Your OAuth Credentials
• Test: POST https://apitest.cybersource.com/kms/egress/v2/keys-sym
• Production: POST https://api.cybersource.com/kms/egress/v2/keys-sym
• India Production: POST https://api.in.cybersource.com/kms/egress/v2/keys-sym
Required Fields for Providing Your OAuth
Credentials
clientRequestAction Set to STORE.
keyInformation.clientKeyId Set to the OAuth client's username.
keyInformation.expiryDuration Set to 365.
keyInformation.key Set to the client's secret key.
keyInformation.keyType Set to oAuthClientCredentials.
keyInformation.organizationId Set to the organization ID or merchant ID of
the organization requesting the key.
keyInformation.provider Set to the organization ID that the
requesting organization belongs to.
keyInformation.tenant Set to nrtd.
Example: Providing Your OAuth Credentials
{
"clientRequestAction": "STORE",
"keyInformation": {
"provider": "merchantName",
"tenant": "nrtd",
"keyType": "oAuthClientCredentials",
"organizationId": "merchantName",
"clientKeyId": "client username",
"key": "client secret",
"expiryDuration": "365"
 }
}
{
"submitTimeUtc": "2022-02-18T19:49:52Z",
"status": "SUCCESS",
"keyInformation": {
"provider": "org1",
"tenant": "nrtd",
"organizationId": "org1",
"clientKeyId": "ef400ac1-edfe-406e-94b3-0d73be09a1a0",
Cybersource Provide Your OAuth Credentials 34
Provide Your OAuth Credentials
"keyId": "d8512fb5-1d8c-4f2d-e053-3cb8d30a764c",
"key": "KTTY1LLGYR6A2LL4XZTT9W9RGCVJ5Z4XZAP6AFTRUFWLSXX0NX4N88N9EJED3BMM",
"keyType": "oAuthClientCredentials",
"status": "active",
"expirationDate": "2023-02-18T19:49:52Z"
 }
}

REST Interactive Example: Providing Your
OAuth Credentials
Click this image to access the interactive code example for providing your OAuth
credentials to Cybersource. The Live Console refers to this request as Store oAuth
Credentials.
Providing Your OAuth Credentials
Cybersource Provide Your OAuth Credentials 35
Retrieve a List of Products and Events
Retrieve a List of Products
and Events
This section describes how to retrieve a list of the products and event types that are
enabled for your organization. Use this list to know which products and events that you
can subscribe to. A successful response lists the enabled products and events in the
productId and eventTypes.eventName elds. You can use these same elds values when
you send a create a webhook subscription request.
If the list you retrieve does not contain an expected product or event type, the product
may not be enabled for your organization. Contact your account manager for more
information.
For a list of all the products and event types that are supported by the Webhooks REST
API, see the Supported Products and Event Types on page 16.
Endpoints
Send a GET request to one of these endpoints. The {organizationId} is your organization
ID.
• Test: GET https://apitest.cybersource.com/notication-subscriptions/v2/
products/{organizationId}
• Production: GET https://api.cybersource.com/webhooks/notication-subscriptions/v2/
products/{organizationId}
• India Production: GET https://api.in.cybersource.com/notication-subscriptions/v2/
products/{organizationId}
Example: Retrieving a List Products and
Event
GET https://api.cybersource.com/notication-subscriptions/v2/products/{organizationId}
[
Cybersource Retrieve a List of Products and Events 36
Retrieve a List of Products and Events
 {
"productId": "terminalManagement",
"eventTypes": [
 {
"eventName": "terminalManagement.status.update",
"payloadEncryption": false
 },
 {
"eventName": "terminalManagement.assignment.update",
"payloadEncryption": false
 },
 {
"eventName": "terminalManagement.reAssignment.update",
"payloadEncryption": false
 }
 ]
 }
]
REST Interactive Example: Retrieving Product
and Event Types
Click this image to access the interactive code example for retrieving the product and
event types enabled for your organization.
Cybersource Retrieve a List of Products and Events 37
Retrieve a List of Products and Events
Retrieve Product and Event Types
Cybersource Retrieve a List of Products and Events 38
Create a Webhook Subscription
Create a Webhook
Subscription
This section describes how to create a webhook subscription using the REST API.
The request you send is dependent on your system's security policy:
• Mutual trust (default)
• Mutual trust and OAuth
• Mutual trust and OAuth with JWT
The Webhooks REST API uses the mutual trust security policy by default. In addition to
mutual trust, you can also use the OAuth or OAuth JWT security policy. If you are not using
OAuth security to authenticate your webhook notications, use the default mutual trust
request.
Create a Webhook Subscription Using Mutual
Trust
This section describes how to create webhook subscription using mutual trust. You can
subscribe to multiple webhook products and event types in the same request.
Mutual trust is the default security policy for webhooks. It is a simple authentication
scheme that is included in the HTTP protocol. Mutual trust is often used in conjunction
with HTTPS to provide condentiality through encryption.
Health Check URL
Cybersource recommends that you include a health check URL in the subscription
request. A health check URL ensures that you do not miss any notications. For more
information, see Webhook Health Check URL and Automatic Revalidation on page 61.
Cybersource Create a Webhook Subscription 39
Create a Webhook Subscription
Retry Policy
If your webhook URL or health check URL are unresponsive when sent a notication,
Cybersource resends the notication according to the subscription's retry policy. By
default, Cybersource sends you 3 notication attempts, beginning 1 minute after the
initial failed attempt. Each retry attempt occurs in 1 minute intervals if your URL remains
unresponsive. You can congure the default retry policy when you create or update a
subscription. For more information about how to congure the retry policy, see Congure
the Retry Policy on page 63.
Subscription ID
Important
After sending this request, you receive a response with a subscription ID in the
webhookId eld. Save this ID in your system to send follow-on requests that enable
you to update and manage the subscription. For more information about the
follow-on requests, see Manage Webhook Subscriptions Requests on page 75.
Endpoints
Send a POST request to one of these endpoints:
• Test: POST https://apitest.cybersource.com/notication-subscriptions/v2/webhooks
• Production: POST https://api.cybersource.com/notication-subscriptions/v2/webhooks
• India Production: POST https://api.in.cybersource.com/notication-subscriptions/v2/
webhooks
Required Fields for Subscribing to Webhooks Using Mutual Trust
description
name
organizationId Set to your organization ID or merchant ID.
products.eventTypes For a list of event types, see Supported
Products and Event Types on page 16.
products.productId For a list of product IDs, see Supported
Products and Event Types on page 16.
securityPolicy.securityType Set to KEY.
webhookUrl
Optional Fields for Subscribing to Webhooks Using Mutual Trust
deactivateag Required if healthCheckUrl eld is present.
Cybersource Create a Webhook Subscription 40
Create a Webhook Subscription
Set to true to automatically activate the
subscription.
healthCheckUrl Set to the health check URL. Required
to auto-activate the subscription. If you
do not include this eld, the created
subscription is inactive. An inactive
subscription does not send notications.
For more information, see Webhook Health
Check URL and Automatic Revalidation on
page 61.
noticationScope.scopeData Set to the organization IDs that you want to
receive notications for when events occur
in those organizations. Concatenate each
organization ID with the comma character
(,).
retryPolicy.deactivateFlag For more information, see Congure the
Retry Policy on page 63.
retryPolicy.rstRetry For more information, see Congure the
Retry Policy on page 63.
retryPolicy.interval For more information, see Congure the
Retry Policy on page 63.
retryPolicy.numberOfRetries For more information, see Congure the
Retry Policy on page 63.
retryPolicy.repeatSequenceCount For more information, see Congure the
Retry Policy on page 63.
retryPolicy.repeatSequenceWaitTime For more information, see Congure the
Retry Policy on page 63.
Example: Creating a Webhook Subscription Using Mutual Trust
{
"name": "My Custom Webhook",
"description": "Sample Webhook from Developer Center",
"organizationId": "<SET TO YOUR ORGANIZATION ID OR MERCHANT ID>",
"products": [
 {
"productId": "product.name",
"eventTypes": [
"product.name.event.type"
 ]
 }
 ],
"webhookUrl": "https://MyWebhookServer.com:8443/simulateClient",
"securityPolicy": {
"securityType": "KEY"
Cybersource Create a Webhook Subscription 41
Create a Webhook Subscription
 }
}
Response to a Successful Request
{
"organizationId": "organizationId",
"productId": "terminalManagement",
"eventTypes": [
"terminalManagement.assignment.update"
 ],
"webhookId": "ddb9bced-c3e3-1b1d-e053-9c588e0a3c42",
"name": "My Custom Webhook",
"webhookUrl": "https://MyWebhookServer.com:443/simulateClient",
"healthCheckUrl": "https://MyWebhookServer.com:443/simulateClientHealthCheck",
"createdOn": "2022-04-28T15:39:56.928Z",
"status": "ACTIVE",
"description": "Sample Webhook from Developer Center",
"retryPolicy": {
"algorithm": "ARITHMETIC",
"rstRetry": "1",
"interval": "1",
"numberOfRetries": "3",
"deactivateFlag": "false",
"repeatSequenceCount": '0",
"repeatSequenceWaitTime": "0"
 },
"securityPolicy": {
"securityType": "KEY",
"digitalSignatureEnabled": "yes"
 },
"version": "3",
"noticationScope": "SELF"
}
Response Codes
A successful request is indicated by the 200-level response code. For more information
about all of the possible response codes you can receive, see Transaction Response
Codes.
Notication Scope Response Indicators
The noticationScope response eld indicates which organizations receive the webhook
notication. By default, notications use the DESCENDANTS setting. To modify this setting,
include the noticationScope.scopeData eld in your request.
These are all possible eld values:
SELF Only the organization creating the webhook
subscription receives notications when a
subscribed event occurs.
DESCENDANTS (default) The organization creating the webhook
subscription receives notications
when a subscribed event occurs in their
Cybersource Create a Webhook Subscription 42
Create a Webhook Subscription
organization and in any of their children/
descendant accounts in their portfolio
hierarchy. This is the default notication
setting.
CUSTOM The organization creating the webhook
subscription receives notications
when a subscribed event occurs in their
organization and in any organization listed
in the noticationScope.scopeData request
eld.
Subscription Statuses
When you create a subscription, its status is indicated in the status response eld. If you
did not include a health check URL in your request, the subscription is set to INACTIVE. If
you included a health check URL and Cybersource receives a response from the health
check URL, the subscription status is set to ACTIVE.
These are the three possible statuses a subscription can be set to:
ACTIVE The subscription is ready to send
notications or is actively sending
notications.
INACTIVE The subscription has not been activated.
Add a health check URL to activate it. For
more information, see Webhook Health
Check URL and Automatic Revalidation on
page 61.
SUSPENDED The subscription was active, but the
webhook URL or the health check URL
became unreachable. When the URL
becomes reachable, the status changes to
ACTIVE and notications resume.
REST Interactive Example: Create a Webhook Subscription
Click this image to access the interactive code example for creating a webhook
subscription.
Cybersource Create a Webhook Subscription 43
Create a Webhook Subscription
Create a Webhook Subscription
Create a Webhook Subscription Using OAuth
This section describes how to create a webhook subscription using the OAuth security
policy. You can subscribe to multiple webhook products and event types in the same
request. After creating a subscription, you receive a notication every time your
subscribed events occur.
The OAuth security policy with client credentials is an authentication method that is
designed for applications to communicate with each other. Basic authentication is the
most common mechanism for authenticating a client with the client credentials. This
authentication method enables Cybersource services to obtain only the relevant user
data without exposing the user's credentials.
Cybersource Create a Webhook Subscription 44
Create a Webhook Subscription
Health Check URL
Cybersource recommends that you include a health check URL in the subscription
request. A health check URL ensures that you do not miss any notications. For more
information, see Webhook Health Check URL and Automatic Revalidation on page 61.
Retry Policy
If your webhook URL or health check URL are unresponsive when sent a notication,
Cybersource resends the notication according to the subscription's retry policy. By
default, Cybersource sends you 3 notication attempts, beginning 1 minute after the
initial failed attempt. Each retry attempt occurs in 1 minute intervals if your URL remains
unresponsive. You can congure the default retry policy when you create or update a
subscription. For more information about how to congure the retry policy, see Congure
the Retry Policy on page 63.
Subscription ID
Important
After sending this request, you receive a response with a subscription ID in the
webhookId eld. Save this ID in your system to send follow-on requests that enable
you to update and manage the subscription. For more information about the
follow-on requests, see Manage Webhook Subscriptions Requests on page 75.
Endpoints
Send a POST request to one of these endpoints:
• Test: POST https://apitest.cybersource.com/notication-subscriptions/v2/webhooks
• Production: POST https://api.cybersource.com/notication-subscriptions/v2/webhooks
• India Production: POST https://api.in.cybersource.com/notication-subscriptions/v2/
webhooks
Required Fields for Subscribing to Webhooks Using OAuth
description
name
organizationId Set to your organization ID or merchant ID.
products.eventTypes For a list of event types, see Supported
Products and Event Types on page 16.
products.productId For a list of product IDs, see Supported
Products and Event Types on page 16.
securityPolicy.cong.oAuthTokenExpiry
securityPolicy.cong.oAuthTokenType Set to Bearer
Cybersource Create a Webhook Subscription 45
Create a Webhook Subscription
securityPolicy.cong.oAuthURL
securityPolicy.securityType Set to oAuth.
webhookUrl
Optional Fields for Subscribing to Webhooks Using OAuth
deactivateag Required if healthCheckUrl eld is present.
Set to true to automatically activate the
subscription.
healthCheckUrl Set to the health check URL. Required
to auto-activate the subscription. If you
do not include this eld, the created
subscription is inactive. An inactive
subscription does not send notications.
For more information, see Webhook Health
Check URL and Automatic Revalidation on
page 61.
noticationScope.scopeData Set to the organization IDs that you want to
receive notications for when subscribed
events occur in those organizations.
Concatenate each organization ID with the
comma character (,).
retryPolicy.deactivateFlag For more information, see Congure the
Retry Policy on page 63.
retryPolicy.rstRetry For more information, see Congure the
Retry Policy on page 63.
retryPolicy.interval For more information, see Congure the
Retry Policy on page 63.
retryPolicy.numberOfRetries For more information, see Congure the
Retry Policy on page 63.
retryPolicy.repeatSequenceCount For more information, see Congure the
Retry Policy on page 63.
retryPolicy.repeatSequenceWaitTime For more information, see Congure the
Retry Policy on page 63.
Example: Creating a Webhook Subscription Using OAuth
{
"name": "My Custom Webhook",
"description": "",
"organizationId": "<INSERT ORGANIZATION ID HERE>",
"products": [
 {
Cybersource Create a Webhook Subscription 46
Create a Webhook Subscription
"productId": "product.name",
"eventTypes": [
"product.name.event.type"
 ]
 }
 ],
"webhookUrl": "https://MyWebhookServer.com:8443/simulateClient",
"securityPolicy": {
"securityType": "oAuth",
"cong": {
"oAuthTokenExpiry": 365,
"oAuthURL": "https://MyWebhookServer.com:8443/oAuthToken",
"oAuthTokenType": "Bearer"
 }
 }
}
{
"organizationId" : "org1",
"productId" : "terminalManagement",
"eventTypes" : [
"terminalManagement.assignment.update"
],
"webhookId" : "d7399cb6-ff9f-72d9-e053-3cb8d30a62ee",
"webhookUrl" : "https://mywebhookserver.com/simulateclient",
"healthCheckUrl" : "https://mywebhookserver.com/simulateclient/healthcheck",
"createdOn" : "2022-02-04T22:17:43.045Z",
"status" : "INACTIVE",
"retryPolicy" : {
"algorithm" : "ARITHMETIC",
"rstRetry" : "1",
"interval" : "1",
"numberOfRetries" : "3",
"deactivateFlag" : "false",
"repeatSequenceCount" : "0",
"repeatSequenceWaitTime" : "0"
 },
"securityPolicy" : {
"securityType" : "oAuth",
"proxyType" : "internal",
"digitalSignatureEnabled" : "yes",
"cong" : {
"oAuthTokenExpiry" : "300,
"oAuthURL" : "https://myoauthserver.com/simulator/v1/token",
"oAuthTokenType" : "Bearer"
 }
 },
"version" : "3",
"noticationScope" : "SELF"
}
Cybersource Create a Webhook Subscription 47
Create a Webhook Subscription
Response Codes
A successful request is indicated by the 200-level response code. For more information
about all of the possible response codes you can receive, see Transaction Response
Codes.
Notication Scope Response Indicators
The noticationScope response eld indicates which organizations receive the webhook
notication. By default, notications use the DESCENDANTS setting. To modify this setting,
include the noticationScope.scopeData eld in your request.
These are all possible eld values:
SELF Only the organization creating the webhook
subscription receives notications when a
subscribed event occurs.
DESCENDANTS (default) The organization creating the webhook
subscription receives notications
when a subscribed event occurs in their
organization and in any of their children/
descendant accounts in their portfolio
hierarchy. This is the default notication
setting.
CUSTOM The organization creating the webhook
subscription receives notications
when a subscribed event occurs in their
organization and in any organization listed
in the noticationScope.scopeData request
eld.
Subscription Statuses
When you create a subscription, its status is indicated in the status response eld. If you
did not include a health check URL in your request, the subscription is set to INACTIVE. If
you included a health check URL and Cybersource receives a response from the health
check URL, the subscription status is set to ACTIVE.
These are the three possible statuses a subscription can be set to:
ACTIVE The subscription is ready to send
notications or is actively sending
notications.
INACTIVE The subscription has not been activated.
Add a health check URL to activate it. For
more information, see Webhook Health
Check URL and Automatic Revalidation on
page 61.
Cybersource Create a Webhook Subscription 48
Create a Webhook Subscription
SUSPENDED The subscription was active, but the
webhook URL or the health check URL
became unreachable. When the URL
becomes reachable, the status changes to
ACTIVE and notications resume.
REST Interactive Example: Create a Webhook Subscription Using OAuth
Click this image to access the interactive code example for creating a webhook
subscription using OAuth.
Cybersource Create a Webhook Subscription 49
Create a Webhook Subscription
Create a Webhook Subscription Using OAuth
Create a Webhook Subscription Using OAuth
with JWT
This section describes how to create a webhook subscription using OAuth with a JSON
Web Token (JWT). You can subscribe to multiple webhook products and event types in the
same request. After creating a subscription, you receive a notication every time your
subscribed events occur.
The OAuth with JWT security policy is an authentication method in which your system
sends a JSON Web Token. This method bypasses domain headers and minimizes the need
for server-side authentication checks.
Cybersource Create a Webhook Subscription 50
Create a Webhook Subscription
Health Check URL
Cybersource recommends that you include a health check URL in the subscription
request. A health check URL ensures that you do not miss any notications. For more
information, see Webhook Health Check URL and Automatic Revalidation on page 61.
Retry Policy
If your webhook URL or health check URL are unresponsive when sent a notication,
Cybersource resends the notication according to the subscription's retry policy. By
default, Cybersource sends you 3 notication attempts, beginning 1 minute after the
initial failed attempt. Each retry attempt occurs in 1 minute intervals if your URL remains
unresponsive. You can congure the default retry policy when you create or update a
subscription. For more information about how to congure the retry policy, see Congure
the Retry Policy on page 63.
Subscription ID
Important
After sending this request, you receive a response with a subscription ID in the
webhookId eld. Save this ID in your system to send follow-on requests that enable
you to update and manage the subscription. For more information about the
follow-on requests, see Manage Webhook Subscriptions Requests on page 75.
Endpoints
Send a POST request to one of these endpoints:
• Test: POST https://apitest.cybersource.com/notication-subscriptions/v2/webhooks
• Production: POST https://api.cybersource.com/notication-subscriptions/v2/webhooks
• India Production: POST https://api.in.cybersource.com/notication-subscriptions/v2/
webhooks
Required Fields for Subscribing to Webhooks Using OAuth with JWT
description
name
organizationId Set to your organization ID or merchant ID.
products.eventTypes For a list of event types, see Supported
Products and Event Types on page 16.
products.productId For a list of product IDs, see Supported
Products and Event Types on page 16.
securityPolicy.cong.additionalCong.aud
securityPolicy.cong.additionalCong.client_id
Cybersource Create a Webhook Subscription 51
Create a Webhook Subscription
securityPolicy.cong.additionalCong.keyId
securityPolicy.cong.additionalCong.scope
securityPolicy.cong.oAuthTokenExpiry Set to 365.
securityPolicy.cong.oAuthTokenType Set to Bearer.
securityPolicy.cong.oAuthUrl
securityPolicy.securityType Set to oAuth_JWT.
webhookUrl
Optional Fields for Subscribing to Webhooks Using OAuth with JWT
deactivateag Required if the healthCheckUrl eld is
present.
Set to true to automatically activate the
subscription.
healthCheckUrl Set to the health check URL. Required
to auto-activate the subscription. If you
do not include this eld, the created
subscription is inactive. An inactive
subscription does not send notications.
For more information, see Webhook Health
Check URL and Automatic Revalidation on
page 61.
noticationScope.scopeData Set to the organization IDs that you want to
receive notications for when events occur
in those organizations. Concatenate each
organization ID with the comma character
(,).
retryPolicy.deactivateFlag For more information, see Congure the
Retry Policy on page 63.
retryPolicy.rstRetry For more information, see Congure the
Retry Policy on page 63.
retryPolicy.interval For more information, see Congure the
Retry Policy on page 63.
retryPolicy.numberOfRetries For more information, see Congure the
Retry Policy on page 63.
retryPolicy.repeatSequenceCount For more information, see Congure the
Retry Policy on page 63.
retryPolicy.repeatSequenceWaitTime For more information, see Congure the
Retry Policy on page 63.
Cybersource Create a Webhook Subscription 52
Create a Webhook Subscription
Example: Creating a Webhook Subscription Using OAuth with JWT
{
"name": "My Custom Webhook",
"description": "Sample Webhook from Developer Center",
"organizationId": "<INSERT ORGANIZATION ID HERE>",
"products": [
 {
"productId": "product.id",
"eventTypes": [
"product.id.event.type"
 ]
 }
 ],
"webhookUrl": "https://MyWebhookServer.com:8443/simulateClient",
"securityPolicy": {
"securityType": "oAuth_JWT",
"cong": {
"oAuthTokenExpiry": "365",
"oAuthURL": "https://MyWebhookServer.com:443/oAuthToken",
"oAuthTokenType": "Bearer",
"additionalCong": {
"aud": "idp.api.myServer.com",
"client_id": "650538A1-0000-0000-0000-932ABC57AD70",
"keyId": "y-00000000000000-eAZ34pR9Ts",
"scope": "merchantacq:rte:write"
 }
 }
 }
}
{
"organizationId": "organizationId",
"productId": "product.id",
"eventTypes": [
"product.id.event.type"
 ],
"webhookId": "fe46bf08-3918-21ba-e053-a1588d0aeefa",
"name": "My Custom Webhook",
"webhookUrl": "https://MyWebhookServer.com:443/simulateClient",
"healthCheckUrl": "https://MyWebhookServer.com:443/simulateClientHealthCheck",
"createdOn": "2023-06-16T21:19:54.667Z",
"status": "INACTIVE",
"description": "Sample Webhook from Developer Center",
"retryPolicy": {
"algorithm": "ARITHMETIC",
"rstRetry": 1,
"interval": 1,
"numberOfRetries": 3,
"deactivateFlag": false,
"repeatSequenceCount": 0,
"repeatSequenceWaitTime": 0
 },
"securityPolicy": {
"securityType": "oAuth_JWT",
Cybersource Create a Webhook Subscription 53
Create a Webhook Subscription
"proxyType": "external",
"digitalSignatureEnabled": "yes",
"cong": {
"oAuthTokenExpiry": 365,
"oAuthURL": "https://MyWebhookServer.com:443/oAuthToken",
"oAuthTokenType": "Bearer",
"additionalCong": {
"aud": "idp.api.myServer.com",
"client_id": "650538A1-0000-0000-0000-932ABC57AD70",
"keyId": "y-00000000000000-eAZ34pR9Ts",
"scope": "merchantacq:rte:write"
 }
 }
 },
"version": "3",
"deliveryType": "nrtdCentral",
"noticationScope": "SELF"
}
Response Codes
A successful request is indicated by the 200-level response code. For more information
about all of the possible response codes you can receive, see Transaction Response
Codes.
Notication Scope Response Indicators
The noticationScope response eld indicates which organizations receive the webhook
notication. By default, notications use the DESCENDANTS setting. To modify this setting,
include the noticationScope.scopeData eld in your request.
These are all possible eld values:
SELF Only the organization creating the webhook
subscription receives notications when a
subscribed event occurs.
DESCENDANTS (default) The organization creating the webhook
subscription receives notications
when a subscribed event occurs in their
organization and in any of their children/
descendant accounts in their portfolio
hierarchy. This is the default notication
setting.
CUSTOM The organization creating the webhook
subscription receives notications
when a subscribed event occurs in their
organization and in any organization listed
in the noticationScope.scopeData request
eld.
Cybersource Create a Webhook Subscription 54
Create a Webhook Subscription
Subscription Statuses
When you create a subscription, its status is indicated in the status response eld. If you
did not include a health check URL in your request, the subscription is set to INACTIVE. If
you included a health check URL and Cybersource receives a response from the health
check URL, the subscription status is set to ACTIVE.
These are the three possible statuses a subscription can be set to:
ACTIVE The subscription is ready to send
notications or is actively sending
notications.
INACTIVE The subscription has not been activated.
Add a health check URL to activate it. For
more information, see Webhook Health
Check URL and Automatic Revalidation on
page 61.
SUSPENDED The subscription was active, but the
webhook URL or the health check URL
became unreachable. When the URL
becomes reachable, the status changes to
ACTIVE and notications resume.
REST Interactive Example: Create a Webhook Subscription Using OAuth with
JWT
Click this image to access the interactive code example for creating a webhook
subscription using OAuth with JWT.
Cybersource Create a Webhook Subscription 55
Create a Webhook Subscription
Create a Webhook Subscription Using OAuth with JWT
Examples of all Products and Event Types
This section shows examples of creating a subscription with every supported product and
event type. Use these examples as references for how to properly format the product IDs
and event types when you create a subscription.
Request Examples for Creating a Subscription for all Products and
Event Types
Alternative Payments Request
{
"name": "My Custom Webhook",
"description": "Sample Webhook from Developer Center",
"organizationId": "<SET TO YOUR ORGANIZATION ID OR MERCHANT ID>",
"products": [
Cybersource Create a Webhook Subscription 56
Create a Webhook Subscription
 {
"productId": "alternativePaymentMethods",
"eventTypes": [
"payments.payments.updated"
 ]
 }
 ],
"webhookUrl": "https://MyWebhookServer.com:8443/simulateClient",
"securityPolicy": {
"securityType": "KEY"
 }
}
eCheck Request
{
"name": "My Custom Webhook",
"description": "Sample Webhook from Developer Center",
"organizationId": "<SET TO YOUR ORGANIZATION ID OR MERCHANT ID>",
"products": [
 {
"productId": "eCheck",
"eventTypes": [
"payments.credits.accepted",
"payments.credits.failed",
"payments.payments.accepted",
"payments.payments.failed",
"payments.voids.accepted",
"payments.voids.failed"
 ]
 }
 ],
"webhookUrl": "https://MyWebhookServer.com:8443/simulateClient",
"securityPolicy": {
"securityType": "KEY"
 }
}
Fraud Management Essentials Request
{
"name": "My Custom Webhook",
"description": "Sample Webhook from Developer Center",
"organizationId": "<SET TO YOUR ORGANIZATION ID OR MERCHANT ID>",
"products": [
 {
"productId": "fraudManagementEssentials",
"eventTypes": [
"risk.casemanagement.decision.accept",
"risk.casemanagement.addnote",
"risk.prole.decision.reject",
"risk.casemanagement.decision.reject",
"risk.prole.decision.monitor",
"risk.prole.decision.review"
 ]
 }
Cybersource Create a Webhook Subscription 57
Create a Webhook Subscription
 ],
"webhookUrl": "https://MyWebhookServer.com:8443/simulateClient",
"securityPolicy": {
"securityType": "KEY"
 }
}
Invoicing Request
{
"name": "My Custom Webhook",
"description": "Sample Webhook from Developer Center",
"organizationId": "<SET TO YOUR ORGANIZATION ID OR MERCHANT ID>",
"products": [
 {
"productId": "customerInvoicing",
"eventTypes": [
"invoicing.customer.invoice.send",
"invoicing.customer.invoice.cancel",
"invoicing.customer.invoice.paid",
"invoicing.customer.invoice.partial-payment",
"invoicing.customer.invoice.reminder",
"invoicing.customer.invoice.overdue-reminder"
 ]
 }
 ],
"webhookUrl": "https://MyWebhookServer.com:8443/simulateClient",
"securityPolicy": {
"securityType": "KEY"
 }
}
Payments Request
{
"name": "My Custom Webhook",
"description": "Sample Webhook from Developer Center",
"organizationId": "<SET TO YOUR ORGANIZATION ID OR MERCHANT ID>",
"products": [
 {
"productId": "payments",
"eventTypes": [
"payments.capture.status.accepted",
"payments.capture.status.updated"
 ]
 }
 ],
"webhookUrl": "https://MyWebhookServer.com:8443/simulateClient",
"securityPolicy": {
"securityType": "KEY"
 }
}
Pay by Link Merchant Request
{
Cybersource Create a Webhook Subscription 58
Create a Webhook Subscription
"name": "My Custom Webhook",
"description": "Sample Webhook from Developer Center",
"organizationId": "<SET TO YOUR ORGANIZATION ID OR MERCHANT ID>",
"products": [
 {
"productId": "payByLink",
"eventTypes": [
"payByLink.merchant.payment"
 ]
 }
 ],
"webhookUrl": "https://MyWebhookServer.com:8443/simulateClient",
"securityPolicy": {
"securityType": "KEY"
 }
}
Pay by Link Partner Reseller Request
{
"name": "My Custom Webhook",
"description": "Sample Webhook from Developer Center",
"organizationId": "<SET TO YOUR ORGANIZATION ID OR MERCHANT ID>",
"products": [
 {
"productId": "payByLink",
"eventTypes": [
"payByLink.customer.payment"
 ]
 }
 ],
"webhookUrl": "https://MyWebhookServer.com:8443/simulateClient",
"securityPolicy": {
"securityType": "KEY"
 }
}
Recurring Billing Request
{
"name": "My Custom Webhook",
"description": "Sample Webhook from Developer Center",
"organizationId": "<SET TO YOUR ORGANIZATION ID OR MERCHANT ID>",
"products": [
 {
"productId": "recurringBilling",
"eventTypes": [
"rbs.subscriptions.charge.failed",
"rbs.subscriptions.charge.pre-notied",
"rbs.subscriptions.charge.created"
 ]
 }
 ],
"webhookUrl": "https://MyWebhookServer.com:8443/simulateClient",
"securityPolicy": {
"securityType": "KEY"
Cybersource Create a Webhook Subscription 59
Create a Webhook Subscription
 }
}
Token Management Service Request
{
"name": "My Custom Webhook",
"description": "Sample Webhook from Developer Center",
"organizationId": "<SET TO YOUR ORGANIZATION ID OR MERCHANT ID>",
"products": [
 {
"productId": "tokenManagement",
"eventTypes": [
"tms.networktoken.updated",
"tms.networktoken.provisioned,"
"tms.networktoken.binding"
 ]
 }
 ],
"webhookUrl": "https://MyWebhookServer.com:8443/simulateClient",
"securityPolicy": {
"securityType": "KEY"
 }
}
Cybersource Create a Webhook Subscription 60
Optional Set-Up Tasks
Optional Set-Up Tasks
This section describes optional set-up tasks that you can complete while or after creating
a webhook subscription. These tasks are optional and are not required to successfully
set-up webhook subscriptions.
• Include a health check URL to enable Cybersource to monitor your server's status for
reliability.
• Validate the integrity of a webhook notication.
• Set up a retry policy for how to receive notications when your server URL is initially
unresponsive.
Webhook Health Check URL and Automatic
Revalidation
When you create a webhook subscription, Cybersource recommends that you include a
health check URL in the request. Including a health check URL enables Cybersource to
monitor your server's status for reliability. When Cybersource detects that your health
check URL is unresponsive, notication deliveries are withheld until your health check
URL becomes responsive again. A health check URL ensures that you do not miss any
notications.
To add a health check URL to your create a subscription request, include the
healthCheckurl eld and set it to your health check URL. You must also include the
deactivateag eld and set it to true to enable Cybersource to withhold notications for
periods when your server becomes unresponsive.
Automatic Activation
After you successfully create or update a subscription, Cybersource pings your health
check URL within 5—10 minutes. If Cybersource receives a response, the subscription
status automatically becomes ACTIVE and notications are delivered. When Cybersource
does not receive a response, your subscription status remains SUSPENDED until
Cybersource receives a response. If you did not include a health check URL when you
Cybersource Optional Set-Up Tasks 61
Optional Set-Up Tasks
created the subscription, Cybersource pings your webhook URL for automatic activation
instead. You can also activate a subscription that is not automatically activated by sending
a PUT request. For more information, see Activate a Webhook Subscription on page 86.
Webhook Automatic Activation
Automatic Revalidation
After the subscription's initial activation, Cybersource continues to monitor your server
status. If Cybersource detects that your server is unavailable, your subscription status
automatically updates to SUSPENDED, and notications are withheld. When Cybersource
detects that your server is available again, your subscription status automatically updates
to ACTIVE, and all withheld notications are delivered.
Cybersource Optional Set-Up Tasks 62
Optional Set-Up Tasks
Congure the Retry Policy
If your webhook URL or health check URL are unresponsive, Cybersource resends the
webhook notications according to the subscription's retry policy. All subscriptions are
created with a default retry policy. You can congure the default retry policy when you
create a subscription or update the webhook subscription.
To congure a subscription's retry policy, include these required elds in the create a
subscription request or an update a subscription request:
retryPolicy.deactivateFlag Set to one of these possible values:
• false: Notications are not withheld
when your webhook URL or health check
URL are unresponsive. This is the default
value.
• true: Notications are withheld when
your webhook URL or health check URL
are unresponsive, and the subscription
status updates to SUSPENDED. When
the URLs become responsive again, the
withheld notications are sent and the
subscription status updates to ACTIVE.
retryPolicy.rstRetry The number of minutes before the
notication is resent. The default value is 1.
retryPolicy.interval The number of minutes between each retry
attempt. The default value is 1.
retryPolicy.numberOfRetries The number of retry attempts. The default
value is 3.
retryPolicy.repeatSequenceCount The number of times to repeat the retry
sequence. The default value is 0.
retryPolicy.repeatSequenceWaitTime The number of minutes between each
repeat sequence. The default value is 0.
Example: Retry Policy in a Subscription Request
This excerpt example shows how to format a retry policy in a request.
"retryPolicy": {
"rstRetry": "1",
"interval": "1",
"numberOfRetries": "3",
"deactivateFlag": "false",
"repeatSequenceCount": "0",
"repeatSequenceWaitTime": "0"
Cybersource Optional Set-Up Tasks 63
Optional Set-Up Tasks
 }
Validate a Webhook Notication
You can verify that the webhook notications that you receive are from Cybersource.
Verifying your webhook notications validates their integrity and helps prevent replay
attacks.
When you receive a webhook notication from Cybersource, it contains a digital signature.
You can congure your system to compare the notication's digital signature to the digital
signature you created. If both of the digital signatures match, the notication is validated.
You must complete these tasks to validate the webhook notications that you receive:
1. You create a digital signature key by sending a create a digital signature key request to
Cybersource. You may have already completed this requirement while setting up your
rst webhook subscription. For more information, see Create a Digital Signature Key on
page 30.
2. You extract the digital signature from the digital signature key that you created.
3. You congure your system to compare your digital signature to the digital signatures
in the notications that you receive. A webhook notication is valid if the notication's
digital signature matches your digital signature.
Digital Signature Format
When you receive a webhook notication from Cybersource, it contains a v-c-signature
header in this format:
v-c-signature: t=1617830804768;keyId=bf44c857-b182-bb05-e053-34b8d30a7a72;sig=CzHY47nzJgCSD/
BREtSIb+9l/vfkaaL4qf9n8MNJ4CY=";
The header contains these three parameters concatenated with semicolons:
• t: The timestamp at which the digital signature key was created.
• keyId: The digital signature key ID.
• sig: The digital signature. It is encrypted using the HMAC-SHA256 algorithm.
How to Create Your Digital Signature
Create your own digital signature using the above format. Use the key values you received
from creating a digital signature key in your digital signature. When you request the
creation of a digital signature key, the response contains a digital signature key and a key
ID. The digital signature key is in the keyInformation.keyinformation.key eld and the key ID
is in the keyInformation.keyinformation.keyId eld.
Validating a Notication
Follow these steps to validate the integrity of your webhook notications.
Cybersource Optional Set-Up Tasks 64
Optional Set-Up Tasks
1. Separate the signature parameters with a semicolon (;) and extract the t, keyId, and sig
values.
2. Use the keyId value to fetch the digital signature key.
3. Generate the payload by concatenating the timestamp with a period (.) and the payload
from the body of the notication.
4. Use the SHA256 algorithm to encrypt the generated payload from Step 3 using the key
from Step 2.
5. Verify that the encrypted value matches the value in sig parameter.
Example: Validating a Notication
This is an example of a system script that validates webhook notications by the
merchant's digital signature with the webhook notication's signature. Use this example as
a reference for how to potentially congure your system.
import javax.crypto.Mac;
import javax.crypto.spec.SecretKeySpec;
import java.nio.charset.StandardCharsets;
import java.util.Arrays;
import java.util.Base64;
public class Validator {
public static void main(String[] args) {
// Sample signature header
String signatureHeader = "v-c-signature: t=1617830804768;keyId=bf44c857-b182-bb05-
e053-34b8d30a7a72;sig=CzHY47nzJgCSD/BREtSIb+9l/vfkaaL4qf9n8MNJ4CY=";
String payload = "this is a decrypted payload";
// Convert the received signatureHeader into timestamp, keyId, and signature.
DigitalSignature companySignature = new DigitalSignature(signatureHeader);
// Check if the timestamp is within tolerance.
if (companySignature.isValidTimestamp()) {
// Client regenerates their signature using the timestamp from header and received payload.
byte[] signature = regenerateSignature(companySignature.getTimestamp(), payload);
// Check if the generated signature is same as signature received in header.
if (isValidSignature(signature, companySignature.getSignature())) {
System.out.println("Success - Signature is valid");
} else {
System.out.println("Error - Signatures do not match");
 }
} else {
System.out.println("Error - timestamp is outside of tolerance level");
 }
 }
 /**
* Compute HMAC with the SHA256 hash function.
* key is your private key.
* message is timestamp.payload.
* @return
 */
public static byte[] regenerateSignature(long timestamp, String message) {
String timestampedMessage = timestamp + "." + message;
String key = getSecurityKey();
Cybersource Optional Set-Up Tasks 65
Optional Set-Up Tasks
// Generate the hash using key and message.
return calcHmacSHA256(Base64.getDecoder().decode(key),
timestampedMessage.getBytes(StandardCharsets.UTF_8));
 }
 /**
* A mechanism to fetch the security key using keyId from a source. We're using Base64encoded version of
(test_key).
* @return
 */
private static String getSecurityKey() {
return "dGVzdF9rZXk="; //test_key
 }
 /**
* Generate SHA256 using secretKey and a message.
* Sample Hmacgenerator to test: https://8gwi.org/hmacgen.jsp
* @param secretKey
* @param message
* @return
 */
private static byte[] calcHmacSHA256(byte[] secretKey, byte[] message) {
byte[] hmacSha256 = null;
try {
Mac mac = Mac.getInstance("HmacSHA256");
SecretKeySpec secretKeySpec = new SecretKeySpec(secretKey, "HmacSHA256");
mac.init(secretKeySpec);
hmacSha256 = mac.doFinal(message);
} catch (Exception e) {
throw new RuntimeException("Failed to calculate hmac-sha256", e);
 }
return hmacSha256;
 }
 /**
* Compare the Base64 decoding of the signature with the signature received in the header.
* Sample encoder/decoder to test:
* https://www.base64encode.org/
* https://www.base64decode.org/
* @param bankSignature
* @param companySignature
* @return
 */
private static boolean isValidSignature(byte[] bankSignature, String companySignature) {
return Arrays.equals(bankSignature, Base64.getDecoder().decode(companySignature));
 }
}
import java.time.Clock;
public class DigitalSignature {
private long timestamp;
private String keyId;
private String signature;
public DigitalSignature(String digitalSignature) {
try {
//split the header by space. rst part is the key "v-c-signature" second part is the actual signature
String signature = digitalSignature.split(" ")[1];
Cybersource Optional Set-Up Tasks 66
Optional Set-Up Tasks
//separate the actual signature by semicolon. this creates 3 parts (timestamp, keyId, sig)
String[] signatureParts = signature.split(";");
//timestamp section is the rst block. split timestamp section by = sign and actual timestamp is in
the second block
this.timestamp = Long.parseLong(signatureParts[0].split("=")[1]);
//keyId section is the second block. split keyId section by = sign and actual keyId is in the second
block
this.keyId = signatureParts[1].split("=")[1];
//digital signature is the third block. split digital signature by = sign and actual signature is in the
second block. This is Base64 encoded
this.signature = signatureParts[2].split("=")[1];
if unable to format exactly like the above then would recommend the following edit:
/* split the header by space. rst part is the key "v-c-signature" second part is the actual signature
 */
String signature = digitalSignature.split(" ")[1];
/* separate the actual signature by semicolon. this creates 3 parts (timestamp, keyId, sig) */
String[] signatureParts = signature.split(";");
/* timestamp section is the rst block. split timestamp section by = sign and actual timestamp is
in the second block */
this.timestamp = Long.parseLong(signatureParts[0].split("=")[1]);
/* keyId section is the second block. split keyId section by = sign and actual keyId is in the second
block */
this.keyId = signatureParts[1].split("=")[1];
/* digital signature is the third block. split digital signature by = sign and actual signature is in
the second block. This is Base64 encoded */
this.signature = signatureParts[2].split("=")[1];
} catch (Exception e) {
System.out.println("Invalid digital signature format");
 }
 }
public long getTimestamp() {
return timestamp;
 }
public void setTimestamp(long timestamp) {
this.timestamp = timestamp;
 }
public String getKeyId() {
return keyId;
 }
public void setKeyId(String keyId) {
this.keyId = keyId;
 }
public String getSignature() {
return signature;
 }
public void setSignature(String signature) {
this.signature = signature;
Cybersource Optional Set-Up Tasks 67
Optional Set-Up Tasks
 }
 /**
* Using a tolerance of 60 mins
* Compute the current time in UTC and make sure the timestamp was generated within the tolerance
period.
* UTC millis generator to test: https://currentmillis.com/
 *
* @return
 */
public boolean isValidTimestamp() {
long tolerance = 60 * 60 * 1000L; //60 mins
// return Clock.systemUTC().millis() - timestamp < tolerance; // Enable this if you want timestamp
validation.
return true;
 }
}
Cybersource Optional Set-Up Tasks 68
Webhook Notication Header and Message Body Descriptions
Webhook Notication
Header and Message Body
Descriptions
Each webhook notication for an event update contains headers and a message body
with elds. This section describes the possible elds and values you can receive in a
notication.
Notication Headers
These headers are sent in every notication. Some headers contain duplicate information
from the elds in the message body.
V-C-signature The digital signature, which you can use to
validate the security of the notication.
V-C-event-type The type of event that generated the
notication.
V-C-organization-id The identier of the organization that is
subscribed to the notication.
V-C-product-name The name of the product for which the
event occurred.
V-C-request-type The indicator of whether the notication is
new or a retry attempt.
V-C-retry-count The number of times the notication was
resent.
V-C-transaction-trace-id The identier of the notication attempt.
Every retry attempt has a unique
transaction trace ID. The notication ID
remains the same.
v-c-webhook-id The identier of the webhook subscription
that generated the notication.
Cybersource Webhook Notication Header and Message Body Descriptions 69
Webhook Notication Header and Message Body Descriptions
Notication Message Body
The message body contains elds associated with the notication and the payload of the
event that generated the notication.
webhookId The identier of the webhook subscription
that generated the notication.
transactionTraceId The identier of the notication attempt.
Every retry attempt has a unique
transaction trace ID. The notication ID
remains the same.
productId The identier of the product that
generated the event.
organizationId The identier of the organization that is
subscribed to the notication.
eventType The type of event that generated the
notication.
eventDate The timestamp of when the event occurred.
payload The data generated by the event.
requestType The indicator of whether the notication is
new or a retry attempt.
Example: Webhook Notication
This is an example of a received webhook notication. Use this example to know what your system can
expect when you receive a notication.
Invoicing Webhook Notication
POST /test HTTP/1.1
Host: invoicetest.example.com
Content-Length: 1647
Content-Type: application/json
User-Agent: Vert.x-WebClient/3.9.8
V-C-Event-Type: invoicing.customer.invoice.send
V-C-Organization-Id: invoicetest
V-C-Product-Name: customerInvoicing
V-C-Request-Type: NEW
V-C-Retry-Count: 0
V-C-Signature: t=168506218354;keyId=facdaf45-db00-233ce053-5a588d0a743a;sig=kJgSHwHrRgUmXJdaSSqtPVzOTMlV3SW90WAFIfPj4XA=
V-C-Transaction-Trace-Id: 8c01a8e9b3334d19528d9b69a21fe797ebaf8dd3dee52f422dd699af26bd866-0
V-C-Webhook-Id: fc8a9385-723e8e28-e053-a2588e0a536d
{
"noticationId":"fc8f1cae-1232-5dd-e053-a0588e0a5eeb",
"retryNumber":0,
"eventType":"invoicing.customer.invoice.send",
Cybersource Webhook Notication Header and Message Body Descriptions 70
Webhook Notication Header and Message Body Descriptions
"eventDate":"2023-05-25T17:49:40.309-07:00",
"webhookId":"fc8a9385-723e-8e28-e053-a2588e0a536d",
"payloads":[
 {
"data":{
"merchantZip":"12345",
"thankYou":"Thank you for your business!",
"subject":"You've received an invoice 202203789 from Company, Inc.",
"dueDate":"2023-05-25",
"link":"Click the link below to view and pay the invoice.",
"body":"You have a new invoice from Company, Inc. for 102.00 ALL due on 2023-05-25.",
"merchantState":"OH",
"merchantName":"Company, Inc.",
"button":"VIEW AND PAY INVOICE",
"invoiceBalance":"102.00",
"merchantAddress2":" ",
"invoiceNumber":"20220389",
"payerName":"Firstname Lastname",
"customMessage":"Thank you for your business. By clicking the view and pay invoice you agree to the
terms and conditions here: https://paymenttermsandconditions.example.com",
"currency":"ALL",
"merchantCity":"Placeville",
"emailTo":"Person@example.com",
"eventType":"invoicing.customer.invoice.send",
"balanceAmount":"102.00",
"organizationID":"invoicetest",
"merchantPhone":"321-321-3211",
"emailLanguage":"en-us",
"invoiceUrl":"https://businesscentertest.cybersource.com/ebc2/invoicing/payInvoice/
u2wJqUKII4FsqtIrZx51lUuvYr5Msz23nqIx12xqJhs7wqT6Th2mJcDOYHSC5hE?version=v2.1",
"merchantAddress":"39 E. Road St",
"correlationID":"dceb3ce-d787-453c-84a3-ce33b141cc76",
"hello":"Hello Person,"
 },
"preferences":{
"contacts":[
 {
"rstName":"Invoicing",
"lastName":"Email",
"contact":"person@example.com",
"type":"EMAIL"
 }
 ]
 },
"organizationId":"invoicetest",
"metadata":{
"from.displayName":"Company, Inc.",
"reply.email":"noreply@example.com",
"sentBy":"Invoice"
 }
 }
 ]
}
Cybersource Webhook Notication Header and Message Body Descriptions 71
Create a Sample Webhook Subscription
Create a Sample Webhook
Subscription
Follow these steps to create a sample webhook subscription and then
trigger a test webhook notication. This sample subscription uses the Token
Management Service (TMS).
Important
You must rst conrm that your organization ID is enabled for TMS and that a TMS
vault is set up. For assistance, contact Cybersource Customer Support.
1. Create a TMS webhook subscription for your organization ID using this endpoint:
POST https://apitest.cybersource.com/notication-subscriptions/v2/webhooks
Set the productId eld to tokenManagement and the eventTypes eld to
tms.networktoken.provisioned. This example creates a webhook subscription using
Mutual trust, which is the default security policy.
{
"name": "TMS Webhook",
"description": "Sample TMS Webhook from Developer Center",
"organizationId": "organizationId",
"productId": "tokenManagement",
"eventTypes": [
"tms.networktoken.provisioned"
 ],
"webhookUrl": "https://MyWebhookServer.com:8443/simulateClient",
"healthCheckUrl": "https://MyWebhookServer.com:8443/simulateClientHealthCheck",
"noticationScope": "SELF",
"retryPolicy": {
"algorithm": "ARITHMETIC",
"rstRetry": 1,
"interval": 1,
"numberOfRetries": 3,
"deactivateFlag": "false",
"repeatSequenceCount": 0,
"repeatSequenceWaitTime": 0
 },
Cybersource Create a Sample Webhook Subscription 72
Create a Sample Webhook Subscription
"securityPolicy": {
"securityType": "KEY",
"proxyType": "external"
 }
}
2. Go to the Create an Instrument Identier section in the API Field Reference.
3. Click the Conguration tab.
4. In the Sample Request drop-down menu, choose Create Instrument Identier using a
Card and Create Network Token:
5. Set the card.number eld to a test PAN. If you need a test PAN, contact Cybersource
customer support. Send the request to this endpoint:
POST https://apitest.cybersource.com/tms/v1/instrumentidentiers
{
"type": "enrollable card",
"card": {
"number": "411111111111XXXX", // Replace the ‘X’s with 1
"expirationMonth": "12",
"expirationYear": "2031"
 }
}
Important
Cybersource Create a Sample Webhook Subscription 73
Create a Sample Webhook Subscription
A test PAN can only have one associated instrument identier. If you need to
test multiple webhook notications, delete the instrument identier created for
that PAN before using the Delete an Instrument Identier API.
6. Click Send. After you receive a successful response, your system should receive a
webhook event notication.
For an example of a complete webhook notication, including the header and payload
information, see Example: Webhook Notication.
Cybersource Create a Sample Webhook Subscription 74
Manage Webhook Subscriptions Requests
Manage Webhook
Subscriptions Requests
This section describes how to manage your webhook subscriptions using the REST API.
These follow-on requests require the webhook subscription ID.
After you set up a webhook subscription, you can manage your subscription using these
requests:
• Retrieve the details of a subscription
• Retrieve a list of subscriptions by product and event
• Update a subscription
• Delete a subscription
• Verify a subscription's conguration
• Activate a subscription
• Deactivate a subscription
Retrieve the Details of a Webhook
Subscription
This section describes how to retrieve the details of a webhook subscription, such as the
subscription status, which organizations are receiving the notications, and other useful
details.
This request requires the webhook subscription ID. The subscription ID is in the
webhookId response eld from the create a webhook subscription request.
Endpoints
Send a GET request to this endpoint. The {webhookId} is the webhook subscription ID.
• Test: GET apitest.cybersource.com/notication-subscriptions/v2/
webhooks/{webhookId}
Cybersource Manage Webhook Subscriptions Requests 75
Manage Webhook Subscriptions Requests
• Production: GET api.cybersource.com/notication-subscriptions/v2/
webhooks/{webhookId}
• India Production: GET https://api.in.cybersource.com/notication-subscriptions/v2/
webhooks/{webhookId}
Example: Retrieving the Details of a Webhook Subscription
GET https://apitest.cybersource.com/notication-subscriptions/v1/webhooks/ddb9bced-c3e3-1b1de053-9c588e0a3c42
{
"organizationId": "organizationId",
"productId": "terminalManagement",
"eventTypes": [
"terminalManagement.assignment.update"
 ],
"webhookId": "ddb9bced-c3e3-1b1d-e053-9c588e0a3c42",
"webhookUrl": "https://MyWebhookServer.com:443/simulateClient",
"healthCheckUrl": "https://MyWebhookServer.com:443/simulateClientHealthCheck",
"createdOn": "2022-04-28 15:39:56.931",
"status": "SUSPENDED",
"retryPolicy": {
"algorithm": "ARITHMETIC",
"rstRetry": 1,
"interval": 1,
"numberOfRetries": 3,
"deactivateFlag": false,
"repeatSequenceCount": 0,
"repeatSequenceWaitTime": 0
 },
"securityPolicy": {
"securityType": "KEY",
"digitalSignatureEnabled": "yes"
 },
"version": "3",
"deliveryType": "nrtdCentral",
"noticationScope": "DESCENDANTS"
}
Response Codes
A successful request is indicated by the 200-level response code. For more information
about all of the possible response codes you can receive, see Transaction Response
Codes.
REST Interactive Example: Retrieve the Details of a Webhook
Subscription
Click this image to access the interactive code example for retrieving the details of a
webhook subscription.
Cybersource Manage Webhook Subscriptions Requests 76
Manage Webhook Subscriptions Requests
Retrieve the Details of a Webhook Subscription
Retrieve all of an Organization's
Subscriptions
This section describes how to retrieve a list of the webhook subscriptions that an
organization is subscribed to. This request requires you to include the organization ID in
the endpoint as a query parameter. You have the option to include a product ID and event
type as additional query parameters. If you include any of the optional query parameters,
you must concatenate them by separating each parameter with the ampersand character
(&).
Endpoints
Send a GET request to one of these endpoints. The {organization.id} is the organization ID
or merchant ID.
• Test: GET https://apitest.cybersource.com/notication-subscriptions/v2/webhooks?
organizationId={organization.id}
Cybersource Manage Webhook Subscriptions Requests 77
Manage Webhook Subscriptions Requests
• Production: GET https://api.cybersource.com/notication-subscriptions/v2/webhooks?
organizationId={organization.id}
• India Production: GET https://api.in.cybersource.com/notication-subscriptions/v2/
webhooks?organizationId={organization.id}
Required Query Parameters for Retrieving all of an Organization's
Subscriptions
eventType Set to an event type. For a list of event
types, see Supported Products and Event
Types on page 16.
organizationId Set to your organization ID or merchant ID.
productId Set to a product ID. For a list of product IDs,
see Supported Products and Event Types
on page 16.
Optional Query Parameters for Retrieving all of an Organization's
Subscriptions
eventType Set to an event type that corresponds to
the chosen product ID. For a list of event
types, see Supported Products and Event
Types on page 16.
productId Set to a product ID. For a list of product IDs,
see Supported Products and Event Types
on page 16.
Example: Retrieving all of an Organization's Subscriptions
GET https://apitest.cybersource.com/notication-subscriptions/v2/webhooks?
organizationId=organization123&productId=tokenManagement&eventType=tms.networktoken.provisioned
Response Codes
A successful request is indicated by the 200-level response code. For more information
about all of the possible response codes you can receive, see Transaction Response
Codes.
REST Interactive Example: Retrieving all of an Organization's
Subscriptions
Click this image to access the interactive code example for retrieving an organization's
subscription using the product and event.
Cybersource Manage Webhook Subscriptions Requests 78
Manage Webhook Subscriptions Requests
Retrieve an Organization's Subscriptions Using the Product and Event
Update a Webhook Subscription
This section describes how to update a webhook subscription, such as updating the
notication scope, health check URL, or retry policy. Include only the elds that you want
to update in your request.
This request requires the webhook subscription ID. The subscription ID is in the
webhookId response eld from the create a webhook subscription request.
Endpoints
Send a PATCH request to one of these endpoints. The {webhookId} is the webhook
subscription ID.
• Test: PATCH apitest.cybersource.com/notication-subscriptions/v2/
webhooks/{webhookId}
• Production: PATCH api.cybersource.com/notication-subscriptions/v2/
webhooks/{webhookId}
• India Production:PATCH https://api.in.cybersource.com/notication-subscriptions/v2/
webhooks/{webhookId}
Cybersource Manage Webhook Subscriptions Requests 79
Manage Webhook Subscriptions Requests
Optional Fields for Updating a Webhook Subscription
deactivateag Required if the healthCheckUrl eld is
present.
Set to true to automatically activate the
subscription.
description
healthCheckUrl Set to the health check URL. Required
to auto-activate the subscription. If you
do not include this eld, the created
subscription is inactive. An inactive
subscription does not send notications.
For more information, see Webhook Health
Check URL and Automatic Revalidation on
page 61.
name
organizationId Set to your organization ID or merchant ID.
products.eventTypes For a list of event types, see Supported
Products and Event Types on page 16.
products.productId For a list of product IDs, see Supported
Products and Event Types on page 16.
retryPolicy.deactivateFlag For more information, see Congure the
Retry Policy on page 63.
retryPolicy.rstRetry For more information, see Congure the
Retry Policy on page 63.
retryPolicy.interval For more information, see Congure the
Retry Policy on page 63.
retryPolicy.numberOfRetries For more information, see Congure the
Retry Policy on page 63.
retryPolicy.repeatSequenceCount For more information, see Congure the
Retry Policy on page 63.
retryPolicy.repeatSequenceWaitTime For more information, see Congure the
Retry Policy on page 63.
securityPolicy.cong.additionalCong.aud
securityPolicy.cong.additionalCong.client_id
securityPolicy.cong.additionalCong.keyId
securityPolicy.cong.additionalCong.scope
securityPolicy.cong.oAuthUrl
webhookUrl
Cybersource Manage Webhook Subscriptions Requests 80
Manage Webhook Subscriptions Requests
Example: Updating a Webhook Subscription
{
"name": "My Sample Webhook",
"description": "Sample decision manager webhook reject event.",
"products": [
 {
"productId": "decisionManager",
"eventTypes": [
"risk.prole.decision.reject"
 ]
 }
 ],
"webhookUrl": "https://MyWebhookServer.com:8443:/simulateClient",
"healthCheckUrl": "https://MyWebhookServer.com:8443:/simulateClientHealthCheck",
"noticationScope": {
"scope": "CUSTOM"
 }
}
Response Codes
A successful request is indicated by the 200-level response code. For more information
about all of the possible response codes you can receive, see Transaction Response
Codes.
REST Interactive Example: Updating a Webhook Subscription
Click this image to access the interactive code example for updating a webhook
subscription.
Cybersource Manage Webhook Subscriptions Requests 81
Manage Webhook Subscriptions Requests
Updating a Webhook Subscription
Delete a Webhook Subscription
This section describes how to delete a webhook subscription. Deleting a webhook
subscription does not delete the history of webhook notications.
This request requires the webhook subscription ID. The subscription ID is in the
webhookId response eld from the create a webhook subscription request.
Endpoints
Send a DELETE request to one of these endpoints. The {webhookId} is the webhook
subscription ID.
• Test: DELETE apitest.cybersource.com/notication-subscriptions/v2/
webhooks/{webhookId}
• Production: DELETE api.cybersource.com/notication-subscriptions/v2/
webhooks/{webhookId}
Cybersource Manage Webhook Subscriptions Requests 82
Manage Webhook Subscriptions Requests
• India Production: DELETE https://api.in.cybersource.com/notication-subscriptions/v2/
webhooks/{webhookId}
Example: Deleting a Webhook Subscription
DELETE https://apitest.cybersource.com/notication-subscriptions/v2/webhooks/b555a545-58a9-47c7-
aef9-10a8e17f201a
{
"status": "successfully deleted"
}
Response Codes
A successful request is indicated by the 200-level response code. For more information
about all of the possible response codes you can receive, see Transaction Response
Codes.
REST Interactive Example: Deleting a Webhook Subscription
Click this image to access the interactive code example for deleting a webhook
subscription.
Cybersource Manage Webhook Subscriptions Requests 83
Manage Webhook Subscriptions Requests
Deleting a Webhook Subscription
Verify a Webhook Subscription's
Conguration
This section describes how to test if a webhook subscription is congured correctly. Use
this request to verify that the details you are expecting in the webhook notication are
included, such as the notication message and the product and event types.
A successful response includes the expected notication message and the product
and event type. Only the rst event type in your subscription is listed in the eventType
response eld.
This request requires the webhook subscription ID. The subscription ID is in the
webhookId response eld from the create a webhook subscription request.
Important
This endpoint uses the /v1/ path segment.
Cybersource Manage Webhook Subscriptions Requests 84
Manage Webhook Subscriptions Requests
Endpoints
Send a POST request to one of these endpoints. The {webhookId} is the webhook
subscription ID.
• Test: POST apitest.cybersource.com/notication-subscriptions/v1/
webhooks/{webhookId}
• Production: POST api.cybersource.com/notication-subscriptions/v1/
webhooks/{webhookId}
• India Production: POST https://api.in.cybersource.com/notication-subscriptions/v1/
webhooks/{webhookId}
Example: Verifying a Webhook Subscription's Conguration
Request
POST https://apitest.cybersource.com/notication-subscriptions/v1/webhooks/17915c64-73d9-5475-
e063-7cb8d30a8089
Response to a Successful Request
{
"eventDate": "2024-05-08T16:15:23",
"eventType": "tms.networktoken.updated",
"organizationId": "npr_gpn",
"payloads": {
"testPayload": {
"message": "Yay! Your webhook integration worked! This is only a test and an example of what a
webhook message payload looks like. Thank you for using our test feature."
 }
 },
"productId": "tokenManagement",
"requestType": "NEW",
"retryNumber": "0",
"transactionTraceId": "ddd8883c-f14d-48af-bd35-ff9b4a51ca35",
"webhookId": "17915c64-73d9-5475-e063-7cb8d30a8089"
}
Response Codes
A successful request is indicated by the 200-level response code. For more information
about all of the possible response codes you can receive, see Transaction Response
Codes.
REST Interactive Example: Verifying a Webhook Subscription's
Conguration
Click this image to access the interactive code example for testing a webhook
subscription conguration.
Cybersource Manage Webhook Subscriptions Requests 85
Manage Webhook Subscriptions Requests
Testing a Webhook Subscription Conguration
Activate a Webhook Subscription
This section describes how to activate a webhook subscription.
This request requires the webhook subscription ID. The subscription ID is in the
webhookId response eld from the create a webhook subscription request.
Endpoints
Send a PUT request to one of these endpoints. The {webhookId} is the webhook
subscription ID.
• Test: PUT apitest.cybersource.com/notication-subscriptions/v2/
webhooks/{webhookId}/status
• Production: PUT api.cybersource.com/notication-subscriptions/v2/
webhooks/{webhookId}/status
• India Production: PUT https://api.in.cybersource.com/notication-subscriptions/v2/
webhooks/{webhookId}/status
Cybersource Manage Webhook Subscriptions Requests 86
Manage Webhook Subscriptions Requests
Example: Activate a Webhook Subscription
Request
PUT https://apitest.cybersource.com/notication-subscriptions/v2/webhooks/ddb9bced-c3e3-1b1de053-9c588e0a3c42
Response to a Successful Request
{
"status": "ACTIVE"
}
Response Codes
A successful request is indicated by the 200-level response code. For more information
about all of the possible response codes you can receive, see Transaction Response
Codes.
REST Interactive Example: Activating a Webhook Subscription
Click this image to access the interactive code example for activating a webhook
subscription.
Cybersource Manage Webhook Subscriptions Requests 87
Manage Webhook Subscriptions Requests
Activating a Webhook Subscription
Deactivate a Webhook Subscription
This section describes how to deactivate a webhook subscription.
This request requires the webhook subscription ID. The subscription ID is in the
webhookId response eld from the create a webhook subscription request.
Endpoints
Send a PUT request to one of these endpoints. The {webhookId} is the webhook
subscription ID.
• Test: PUT apitest.cybersource.com/notication-subscriptions/v2/
webhooks/{webhookId}/status
• Production: PUT api.cybersource.com/notication-subscriptions/v2/
webhooks/{webhookId}/status
• India Production: PUT https://api.in.cybersource.com/notication-subscriptions/v2/
webhooks/{webhookId}/status
Cybersource Manage Webhook Subscriptions Requests 88
Manage Webhook Subscriptions Requests
Example: Deactivate a Webhook Subscription
Request
PUT https://apitest.cybersource.com/notication-subscriptions/v2/webhooks/ddb9bced-c3e3-1b1de053-9c588e0a3c42
Response to a Successful Request
{
"status": "INACTIVE"
}
Response Codes
A successful request is indicated by the 200-level response code. For more information
about all of the possible response codes you can receive, see Transaction Response
Codes.
REST Interactive Example: Deactivating a Webhook Subscription
Click this image to access the interactive code example for deactivating a webhook
subscription.
Cybersource Manage Webhook Subscriptions Requests 89
Manage Webhook Subscriptions Requests
Deactivating a Webhook Subscription
Cybersource Manage Webhook Subscriptions Requests 90
Troubleshooting Webhook Subscriptions
Troubleshooting Webhook
Subscriptions
If you created a webhook subscription but are not receiving notications:
• Verify that the digital signature key you created includes the correct organization ID.
You can verify the organization ID by locating it in the response for creating the digital
signature key. If the key is congured with the wrong organization ID, send a request for
a new digital signature key using the correct organization ID.
• Verify that your server and the endpoint URL for the webhook are working and are
congured correctly.
• Verify that the notication scope of the subscription is congured to send notications
to the correct organization. You can retrieve the webhook details to verify that the
organization is listed in the organizationId response eld. For more information, see
Retrieve the Details of a Webhook Subscription on page 75. If the organization is
not in the notication scope, you must update the webhook subscription. For more
information, see Update a Webhook Subscription on page 79.
• Verify that the subscription status is ACTIVE. You can do this by retrieving the webhook
details. For more information, see Retrieve the Details of a Webhook Subscription on
page 75. If the webhook is not set to the ACTIVE status:
• Verify that your subscription is congured with a health check URL. If it is not, update
the subscription with a correct URL. You must also verify that the URL is working and
is congured to accept GET and POST requests. For more information, see Webhook
Health Check URL and Automatic Revalidation on page 61.
• Verify that the webhook URL and health check URL contain hypertext transfer
protocol secure (HTTPS). For example:
"webhookUrl": "https://MyWebhookServer.com:443/simulateClient"
"healthCheckUrl": "https://MyWebhookServer.com:443/simulateClientHealthCheck"
Cybersource Troubleshooting Webhook Subscriptions 91